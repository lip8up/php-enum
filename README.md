# php-enum

PHP æšä¸¾åŸºç±»ï¼Œä½¿ç”¨`ç±»å¸¸é‡`ä½œä¸ºæšä¸¾å€¼ï¼Œæ¯ä¸€é¡¹å‡å«æœ‰ `key`ã€`value` ä¸ `label`ã€‚

## å®‰è£…

```bash
composer require lip/php-enum
```

## æ¦‚å¿µ

ä¸€ä¸ªæšä¸¾ï¼Œé€šå¸¸åŒ…å«ï¼š`key`ã€`value`ï¼Œå¦‚ `typescript` ä¸­çš„ä¸‹åˆ—æšä¸¾ï¼š

```ts
enum Direction {
  Up = 1,
  Down = 2,
  Left = 3,
  Right = 4
}
```

å…¶ä¸­ `Up`ã€`Down`ã€`Left`ã€`Right` ä¸º `key`ï¼Œ`1`ã€`2`ã€`3`ã€`4` ä¸º `value`ã€‚

ä¸€äº›å¸¸è§çš„æƒ…å½¢ï¼Œè¿˜éœ€è¦ä¸€ä¸ªæ–‡å­—æè¿°ï¼Œç‰¹åˆ«æ˜¯ä¸­æ–‡ç¯å¢ƒï¼Œå°†ä¸Šé¢ä»£ç æ”¹é€ ä¸€ä¸‹ï¼š

```ts
enum Direction {
  Up = [1, 'ä¸Š'],
  Down = [2, 'ä¸‹'],
  Left = [3, 'å·¦'],
  Right = [4, 'å³']
}
```

æœ¬åº“å°†è¿™ç§æ–‡å­—æè¿°ï¼Œå®šä¹‰ä¸ºæšä¸¾çš„ `label`ï¼Œå³ä¸Šé¢çš„`ä¸Š`ã€`ä¸‹`ã€`å·¦`ã€`å³`ã€‚

ç”±äº PHP æœ¬èº«ä¸æ”¯æŒæšä¸¾ï¼Œè¿™é‡Œæ’°å†™ä¸€ä¸ªç±» `lip\enum\Enum`ï¼Œç»§æ‰¿è¯¥ç±»ï¼Œå®šä¹‰ç±»å¸¸é‡ï¼Œä½œä¸ºæšä¸¾å€¼ã€‚

## ä½¿ç”¨

### æ ‡å‡†ç”¨æ³•ï¼ˆæ¨èï¼‰

æ¯ä¸€ä¸ªç±»å¸¸é‡å‡ä¸ºä¸€ä¸ª`æ•°ç»„`ï¼Œå…¶ä¸­ï¼Œç¬¬ä¸€é¡¹ä¸º `value`ï¼Œç¬¬äºŒé¡¹ä¸º `label`ï¼Œé¡ºåºä¸èƒ½å˜ã€‚

ä¸‹ä¾‹ä¸­ï¼ŒOneã€Twoã€Three ä¸º `key`ï¼Œ1ã€2ã€3 æ˜¯ `value`ï¼Œä¸€ã€äºŒã€ä¸‰æ˜¯ `label`ã€‚

```php
<?php
use lip\enum\Enum;

/**
 * ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„æšä¸¾ã€‚
 * @method static self One()    Oneçš„å‡½æ•°è¯´æ˜
 * @method static self Two()    Twoçš„å‡½æ•°è¯´æ˜
 * @method static self Three()  Threeçš„å‡½æ•°è¯´æ˜
 */
final class Some extends Enum
{
    private const One = [1, 'ä¸€'];
    private const Two = [2, 'äºŒ'];
    private const Three = [3, 'ä¸‰'];
}
```

å®šä¹‰ä¸€ä¸ªä½¿ç”¨ `Some` æšä¸¾ä½œä¸ºå‚æ•°çš„å‡½æ•°ï¼Œä½¿ç”¨`å¼ºç±»å‹`è¿›è¡Œæ ‡æ³¨ï¼š

```php
function useSome(Some $some) {
    // ...
}
```

æ­¤æ—¶ï¼Œå¦‚æœç”¨åˆ«çš„å€¼ï¼Œä¼ é€’ç»™ä¸Šè¿°å‡½æ•° `useSome`ï¼Œåˆ™ä¼šæŠ¥é”™ï¼Œæ¯”å¦‚ä¼ é€’ `Some::One`ï¼Œç”±äºå®ƒçš„å€¼ä¸º `[1, 'ä¸€']`ï¼Œç±»å‹ä¸º `array`ï¼Œè€Œé `Some`ï¼Œæ•…è€Œä¼šæŠ¥é”™ã€‚

`Some` ç»§æ‰¿è‡ª `lip\enum\Enum` ç±»ï¼Œè¯¥ç±»èµ‹äºˆ `Some` ä¸€ä¸ªå¾ˆé‡è¦çš„èƒ½åŠ›ï¼š

> å°†ç±»å¸¸é‡å®šä¹‰ï¼Œè½¬æ¢æˆå¯¹åº”çš„é™æ€æ–¹æ³•ï¼Œè°ƒç”¨æ­¤æ–¹æ³•ï¼Œä¼šè·å¾—å¯¹åº”çš„ `Some` ç±»å®ä¾‹ã€‚

ä¾‹å¦‚ `Some::One()` å¯¹åº”çš„å°±æ˜¯å«æœ‰å¸¸é‡ `Some::One` å€¼çš„ `Some` ç±»å®ä¾‹ï¼Œå¯ä»¥æ— éšœç¢åœ°ä¼ ç»™ `useSome`ï¼š

```php
useSome(Some::One());
```

æ³¨æ„ `Some::One()` æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œå®ƒé€šè¿‡ç±» `lip\enum\Enum` é‡Œçš„é­”æœ¯æ–¹æ³• [__callStatic](https://www.php.net/manual/zh/language.oop5.overloading.php#object.callstatic) æ·»åŠ ï¼Œæœ‰å¤šå°‘ä¸ªç±»å¸¸é‡ï¼Œå°±æœ‰å¤šå°‘ä¸ªå¯¹åº”åå­—çš„é™æ€æ–¹æ³•ã€‚

é‚£ä¹ˆ `useSome` é‡Œå¦‚ä½•è·å–æšä¸¾ç›¸åº”çš„ `key`ã€`value`ã€`label` å‘¢ï¼Ÿè°ƒç”¨ç›¸åº”çš„`å®ä¾‹æ–¹æ³•`å³å¯ï¼Œä¾‹å¦‚ï¼š

```php
function useSome(Some $some)
{
    $key = $some->key();
    $value = $some->value();
    $label => $some->label();
    // $some å¯ä»¥ç›´æ¥å‚ä¸å­—ç¬¦ä¸²è¿æ¥è¿ç®—ï¼Œç›¸å½“äº $some->value() å‚ä¸äº†è¿ç®—ï¼Œä¾‹å¦‚ï¼š
    echo 'some value is: ' . $some;
    // ç›¸å½“äº
    echo 'some value is: ' . $some->value();
}
```

æ›´å¤š `lip\enum\Enum` ç±»å®ä¾‹ & é™æ€æ–¹æ³•å‚è§ä¸‹é¢çš„[`æ–¹æ³•åˆ—è¡¨`](#æ–¹æ³•åˆ—è¡¨)éƒ¨åˆ†ã€‚

> å¼ºçƒˆå»ºè®®å°†ç±»å¸¸é‡å®šä¹‰ä¸º `private`ï¼Œä»¥å…è¢«è®¿é—®åˆ°ï¼Œå§‹ç»ˆä½¿ç”¨ `Some::ConstName()` çš„å½¢å¼è·å–ç›¸åº”çš„æšä¸¾å®ä¾‹ã€‚

### ç®€æ´ç”¨æ³•ï¼ˆä¸éœ€è¦æˆ–è€…ä¸å…³æ³¨ label æ—¶ä½¿ç”¨ï¼‰

æ­¤ç”¨æ³•ä¸å…³æ³¨ `label`ï¼Œæ¯ä¸ªç±»å¸¸é‡å‡ä¸ºå•ä¸€å€¼ï¼Œæ­¤æ—¶ `value`ã€`label` ç›¸åŒï¼Œå‡ä¸ºè¯¥å¸¸é‡å€¼ï¼Œä¸¾ä¾‹æ¥è¯´ï¼š

```php
/**
 * å¦ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„æšä¸¾ã€‚
 * @method static self Haha() å“ˆå“ˆå¤§ç¬‘
 * @method static self Bibi() You can you up, no can no bibi
 */
final class Other extends Enum
{
    private const Haha = 'hh';
    private const Bibi = 'bb';
}

// Other å®ä¾‹çš„ value ä¸ label æ˜¯ç›¸åŒçš„ï¼Œéƒ½æ˜¯ hh
Other::Haha()->value() == Other::Haha()->label()   // true
```

### è¯­æ³•æç¤º

ç”±äº `lip\enum\Enum` ç±»ä½¿ç”¨äº†é­”æœ¯æ–¹æ³•ï¼Œå¯¼è‡´åœ¨è°ƒç”¨è¯¸å¦‚ `Some::One()` æ—¶ï¼Œå…¶ç»“æœä¸èƒ½æ­£ç¡®åœ°ï¼Œè¢«å¼€å‘å·¥å…·åå°„æ­£ç¡®çš„ç±»å‹ï¼Œä¸ºä½¿å¼€å‘å·¥å…·èƒ½æ­£ç¡®åœ°è¯†åˆ«ç±»å‹ï¼Œå¯åœ¨æšä¸¾ç±»çš„æ³¨é‡Šä¸­ï¼Œä¸ºæ¯ä¸€ä¸ªç±»å¸¸é‡å¢åŠ ä¸€è¡Œ `@method static self ConstName() å‡½æ•°è¯´æ˜`ï¼Œå…·ä½“å‚è§ä¸Šé¢çš„ä¾‹å­ã€‚

### æ— æ³•è¢«å®ä¾‹åŒ–

åŸºç±» `lip\enum\Enum` å°†æ„é€ å‡½æ•°è®¾ä¸º `protected`ï¼Œç¦æ­¢é€šè¿‡æ„é€ å‡½æ•°å®ä¾‹åŒ–æšä¸¾ç±»ï¼Œè¯·å§‹ç»ˆä½¿ç”¨ `Some::ConstName()` çš„å½¢å¼ã€‚

## æ–¹æ³•åˆ—è¡¨

### å®ä¾‹æ–¹æ³•

æ–¹æ³•å | è¯´æ˜
--- | ---
key() | è·å–æšä¸¾ keyã€‚
value() | è·å–æšä¸¾ valueã€‚
label() | è·å–æšä¸¾ labelã€‚
__toString() | æ— æ³•è¢«ä¸»åŠ¨è°ƒç”¨ï¼Œåœ¨å¯¹å®ä¾‹æœ¬èº«è¿›è¡Œå­—ç¬¦ä¸²è¿æ¥æ—¶ï¼Œä¼šè¢«è°ƒç”¨ï¼Œæ­¤å¤„å®ç°ä¸ºï¼š`(string)$this->value`

### é™æ€æ–¹æ³•

å­ç±»å®šä¹‰çš„ç±»å¸¸é‡åï¼Œä¸è¦ä¸ğŸ‘‡çš„é™æ€æ–¹æ³•åŒåã€‚

æ–¹æ³•å | è¯´æ˜
--- | ---
allConstants() | è·å–å…¨éƒ¨å¸¸é‡åˆ—è¡¨ï¼Œæ ¼å¼ï¼š`[ key1 => [value1, label1], ... ]`ï¼Œä¾‹å¦‚ï¼š`[ 'One' => [1, 'ä¸€'], 'Two' => [2, 'äºŒ'], 'Three' => [3, 'ä¸‰'] ]`ã€‚
allKeys() | è·å–å…¨éƒ¨ key åˆ—è¡¨ã€‚
allValues() | è·å–å…¨éƒ¨ value åˆ—è¡¨ã€‚
allLabels() | è·å–å…¨éƒ¨ label åˆ—è¡¨ã€‚
valueToLabel(mixed $value = null) | è·å– $value å¯¹åº”çš„ label æˆ– nullã€‚è‹¥ä¸ä¼ å‚æ•°æˆ–ä¼  nullï¼Œè¿”å›æ•´ä¸ª `map`ï¼Œä¾‹å¦‚ï¼š`[1 => 'ä¸€', 2 => 'äºŒ', 3 => 'ä¸‰']`ã€‚
labelToValue(string $label = null) | è·å– $label å¯¹åº”çš„ value æˆ– nullã€‚è‹¥ä¸ä¼ å‚æ•°æˆ–ä¼  nullï¼Œè¿”å›æ•´ä¸ª `map`ã€‚ä¾‹å¦‚ï¼š`['ä¸€' => 1, 'äºŒ' => 2, 'ä¸‰' => 3]`ã€‚
isValidKey(string $key) | åˆ¤æ–­æ˜¯å¦ä¸ºåˆæ³•çš„ keyã€‚
isValidValue(mixed $value) | åˆ¤æ–­æ˜¯å¦ä¸ºåˆæ³•çš„ valueã€‚
isValidLabel(string $label) | åˆ¤æ–­æ˜¯å¦ä¸ºåˆæ³•çš„ labelã€‚

## å”¯ä¸€å®ä¾‹

ç›¸åŒçš„ç±»å¸¸é‡å€¼ï¼Œæ¯æ¬¡è°ƒç”¨é™æ€æ–¹æ³•ï¼Œå‡è¿”å›å”¯ä¸€çš„ç±»å®ä¾‹ï¼Œå³ï¼š

```php
Some::One() === Some::One()  // true
Some::One() !== Some::One()  // false
```

å› æ­¤ï¼Œåˆ¤æ–­ä¸€ä¸ªæšä¸¾å®ä¾‹ï¼Œæ˜¯å¦ä¸ºæŸä¸ªæšä¸¾æ—¶ï¼Œå¯ä»¥è¿™æ ·ï¼š

```php
if ($some === Some::One()) {
    // ...
} else if ($some === Some::Two()) {
    // ...
} else if ($some === Some::Three()) {
    // ...
} else {
    // ...
}
// æˆ–è€…
switch ($some) {
    case Some::One():
        // ...
        break;
    case Some::Two():
        // ...
        break;
    case Some::Three():
        // ...
        break;
    default:
        // ...
        break;
}
```

## JsonSerializable

`lip\enum\Enum` ç±»å®ç°äº†æ¥å£ `JsonSerializable`ï¼Œä¾‹å¦‚ï¼š

```php
json_encode(Some::One()); // '{"key":"One","value":1,"label":"\u4e00"}'
```

## å•å…ƒæµ‹è¯•

è¿è¡Œ `tests/runtest.sh` æ‰§è¡Œå•å…ƒæµ‹è¯•ï¼Œå·² **100%** æµ‹è¯•é€šè¿‡ï¼Œè¯·æ”¾å¿ƒä½¿ç”¨ã€‚

## ç»“è¯­

æœ‰ä»»ä½•å»ºè®®æˆ–æ”¹è¿›ï¼Œè¯·å‘ [issue](https://github.com/lip8up/php-enum/issues/new)ã€‚

## å¦‚ä½•å‘å¸ƒ

æ‰“ release Tagï¼Œè½¬åˆ° [php-enum](https://packagist.org/packages/lip/php-enum)ï¼Œå°±å¯ä»¥çœ‹åˆ°æ–°ç‰ˆæœ¬äº†ã€‚
